<UserControl x:Class="RentACar.View.AgentRentalsManagement"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:RentACar.View"
             xmlns:converters="clr-namespace:RentACar.Converters"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d"
             Loaded="UserControl_Loaded"
             d:DesignHeight="450"
             d:DesignWidth="800">
    <UserControl.Resources>
        <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:GreaterThanMinusOneConverter x:Key="GreaterThanMinusOneConverter" />
        
        <ControlTemplate x:Key="ComboBoxToggleButton"
                         TargetType="{x:Type ToggleButton}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="30" />
                </Grid.ColumnDefinitions>
                <Border x:Name="Border"
                        Grid.ColumnSpan="2"
                        CornerRadius="6"
                        Background="White"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="1" />
                <Path x:Name="Arrow"
                      Grid.Column="1"
                      Fill="{DynamicResource TextSecondaryBrush}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="M0,0 L4,4 L8,0" />
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsEnabled"
                         Value="False">
                    <Setter TargetName="Border"
                            Property="Opacity"
                            Value="0.5" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <ControlTemplate x:Key="ComboBoxTextBox"
                         TargetType="{x:Type TextBox}">
            <Border x:Name="PART_ContentHost"
                    Focusable="False"
                    Background="{TemplateBinding Background}" />
        </ControlTemplate>

        <Style x:Key="{x:Type ComboBox}"
               TargetType="{x:Type ComboBox}">
            <Setter Property="SnapsToDevicePixels"
                    Value="true" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Height"
                    Value="35" />
            <Setter Property="Padding"
                    Value="8,0" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.CanContentScroll"
                    Value="true" />
            <Setter Property="Foreground"
                    Value="{DynamicResource PrimaryBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton Name="ToggleButton"
                                          Template="{StaticResource ComboBoxToggleButton}"
                                          Focusable="false"
                                          IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"
                                          ClickMode="Press">
                            </ToggleButton>
                            <ContentPresenter Name="ContentSite"
                                              IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="8,0,30,0"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left" />
                            <Popup Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Border x:Name="DropDownBorder"
                                        Background="{DynamicResource BackgroundBrush}"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        MinWidth="{TemplateBinding ActualWidth}"
                                        MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <ScrollViewer Margin="4"
                                                  SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True"
                                                    KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Opacity"
                                        Value="0.5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="{x:Type ComboBoxItem}"
               TargetType="{x:Type ComboBoxItem}">
            <Setter Property="SnapsToDevicePixels"
                    Value="true" />
            <Setter Property="Foreground"
                    Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Padding"
                    Value="8" />
            <Setter Property="OverridesDefaultStyle"
                    Value="true" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                        <Border Name="Border"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted"
                                     Value="true">
                                <Setter TargetName="Border"
                                        Property="Background"
                                        Value="{DynamicResource SecondaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Opacity"
                                        Value="0.5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DataGridColumnHeaderBaseStyle"
               TargetType="DataGridColumnHeader">
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Padding"
                    Value="10,5" />
            <Setter Property="Foreground"
                    Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="FontWeight"
                    Value="SemiBold" />
            <Setter Property="BorderThickness"
                    Value="0,0,0,1" />
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridColumnHeader}">
                        <Grid>
                            <Border x:Name="HeaderBorder"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    Background="{TemplateBinding Background}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <ContentPresenter Grid.Column="0"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Center"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />

                                    <Grid Grid.Column="1"
                                          Width="16"
                                          Margin="0,0,5,0">
                                        <TextBlock Text="▲"
                                                   FontSize="12"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Foreground="{TemplateBinding Foreground}"
                                                   Opacity="0.7">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="Ascending">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="{x:Null}">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="Descending">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>

                                        <TextBlock Text="▼"
                                                   FontSize="12"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Foreground="{TemplateBinding Foreground}"
                                                   Opacity="0.7">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="Descending">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="{x:Null}">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Path=SortDirection, RelativeSource={RelativeSource AncestorType={x:Type DataGridColumnHeader}}}"
                                                                     Value="Ascending">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Grid>
                                </Grid>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter TargetName="HeaderBorder"
                                        Property="Background"
                                        Value="{DynamicResource InputBackgroundBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed"
                                     Value="True">
                                <Setter TargetName="HeaderBorder"
                                        Property="Background"
                                        Value="{DynamicResource BorderBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CustomerText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource Customer}" />
        </Style>
        <Style x:Key="VehicleText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource Vehicle}" />
        </Style>
        <Style x:Key="RentalDateText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource RentalDate}" />
        </Style>
        <Style x:Key="ReturnDateText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource ReturnDate}" />
        </Style>
        <Style x:Key="StatusText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource Status}" />
        </Style>
        <Style x:Key="PriceText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource Price}" />
        </Style>
        <Style x:Key="ActionText"
               TargetType="{x:Type DataGridColumnHeader}"
               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}">
            <Setter Property="HorizontalAlignment"
                    Value="Center" />
            <Setter Property="Content"
                    Value="{DynamicResource Action}" />
        </Style>
    </UserControl.Resources>

    <Grid>
        <!-- Main Rental List Content -->
        <Grid x:Name="RentalListContent"
              Visibility="{Binding IsShowingList, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Title -->
            <TextBlock Grid.Row="0"
                       Text="{DynamicResource RentalsManagement}"
                       FontSize="24"
                       FontWeight="Bold"
                       Margin="20,15,0,25"
                       Foreground="{DynamicResource TextPrimaryBrush}" />

            <!-- Header with search and add button -->
            <Grid Grid.Row="1"
                  Margin="20,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Search Box -->
                <Border Background="{DynamicResource TextSecondaryBrush}"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="10,0"
                        Height="40"
                        Width="300"
                        HorizontalAlignment="Left">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Image Source="pack://application:,,,/Res/search.png"
                               Width="16"
                               Height="16"
                               Margin="5,0,10,0" />
                        <TextBox x:Name="SearchBox"
                                 Grid.Column="1"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 VerticalAlignment="Center"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 TextChanged="SearchBox_TextChanged"
                                 Tag="{DynamicResource SearchRentals}"
                                 ToolTip="{DynamicResource SearchRentals}" />
                    </Grid>
                </Border>

                <!-- Status Filter with Filter Icon and Clear Button -->
                <Grid Grid.Column="1"
                      Width="200"
                      Margin="10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Status Filter ComboBox -->
                    <ComboBox x:Name="StatusFilterComboBox"
                              Grid.Column="0"
                              Height="40"
                              VerticalContentAlignment="Center"
                              BorderThickness="1"
                              BorderBrush="{DynamicResource BorderBrush}"
                              Background="{DynamicResource TextSecondaryBrush}"
                              Foreground="{DynamicResource TextPrimaryBrush}"
                              DisplayMemberPath="NazivStatusa"
                              SelectedValuePath="IdStatusIznajmljivanja"
                              SelectionChanged="StatusFilterComboBox_SelectionChanged">
                        <ComboBox.Resources>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="HorizontalContentAlignment"
                                        Value="Left" />
                            </Style>
                        </ComboBox.Resources>
                    </ComboBox>

                    <!-- Filter Icon  -->
                    <materialDesign:PackIcon Kind="Filter"
                                             Grid.Column="0"
                                             HorizontalAlignment="Right"
                                             VerticalAlignment="Center"
                                             Margin="0,0,165,0"
                                             Foreground="{DynamicResource TextPrimaryBrush}"
                                             Width="20"
                                             Height="20">
                        <materialDesign:PackIcon.Style>
                            <Style TargetType="materialDesign:PackIcon">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ElementName=StatusFilterComboBox, Path=SelectedIndex}"
                                                 Value="-1">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=StatusFilterComboBox, Path=SelectedIndex}"
                                                 Value="{x:Null}">
                                        <Setter Property="Visibility"
                                                Value="Visible" />
                                    </DataTrigger>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding ElementName=StatusFilterComboBox, Path=SelectedIndex}"
                                                       Value="-1" />
                                            <Condition Binding="{Binding ElementName=StatusFilterComboBox, Path=IsDropDownOpen}"
                                                       Value="True" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                    </MultiDataTrigger>
                                    <DataTrigger Binding="{Binding ElementName=StatusFilterComboBox, Path=SelectedIndex, Converter={StaticResource GreaterThanMinusOneConverter}}"
                                                 Value="True">
                                        <Setter Property="Visibility"
                                                Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </materialDesign:PackIcon.Style>
                    </materialDesign:PackIcon>

                    <!-- Clear Filter Button  -->
                    <Button x:Name="ClearStatusFilterButton"
                            Grid.Column="1"
                            Width="30"
                            Height="30"
                            Margin="5,0,0,0"
                            Padding="0"
                            Background="Transparent"
                            BorderBrush="Transparent"
                            Click="ClearStatusFilterButton_Click"
                            Visibility="Collapsed"
                            ToolTip="{DynamicResource ClearFilter}">
                        <materialDesign:PackIcon Kind="FilterRemove"
                                                 Width="20"
                                                 Height="20"
                                                 Foreground="{DynamicResource TextPrimaryBrush}" />
                    </Button>
                </Grid>

                <!-- Add Button -->
                <Button Grid.Column="2"
                        Width="220"
                        Height="40"
                        Click="AddRentalButton_Click">
                    <Button.Resources>
                        <Style TargetType="Button">
                            <Setter Property="Background"
                                    Value="{DynamicResource TextSecondaryBrush}" />
                            <Setter Property="Foreground"
                                    Value="{DynamicResource TextPrimaryBrush}" />
                            <Setter Property="FontWeight"
                                    Value="Bold" />
                            <Setter Property="BorderThickness"
                                    Value="1" />
                        </Style>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="BorderBrush"
                                    Value="{DynamicResource BorderBrush}" />
                            <Setter Property="CornerRadius"
                                    Value="8" />
                        </Style>
                    </Button.Resources>
                    <StackPanel Orientation="Horizontal">
                        <Image Source="pack://application:,,,/Res/rentals.png"
                               Width="25"
                               Height="25"
                               Margin="0,0,10,0" />
                        <TextBlock Text="{DynamicResource AddRental}"
                                   VerticalAlignment="Center" />
                    </StackPanel>
                </Button>
            </Grid>

            <!-- Grid Row 2: DataGrid  -->
            <Grid Grid.Row="2"
                  Margin="20,0,20,20">
                <!--Data grid-->
                <DataGrid x:Name="RentalsDataGrid"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          BorderThickness="0"
                          GridLinesVisibility="None"
                          RowBackground="{DynamicResource TextSecondaryBrush}"
                          AlternatingRowBackground="{DynamicResource InputBackgroundBrush}"
                          Background="Transparent"
                          RowHeight="60"
                          SelectionMode="Single"
                          SelectionChanged="RentalsDataGrid_SelectionChanged">
                    <DataGrid.Resources>
                        <Style TargetType="DataGridColumnHeader"
                               BasedOn="{StaticResource DataGridColumnHeaderBaseStyle}" />
                        <Style TargetType="DataGridCell">
                            <Setter Property="Padding"
                                    Value="10,5" />
                            <Setter Property="BorderThickness"
                                    Value="0" />
                            <Setter Property="VerticalAlignment"
                                    Value="Center" />
                        </Style>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type DataGridRow}">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="6"
                                                Margin="0,1">
                                            <SelectiveScrollingGrid>
                                                <SelectiveScrollingGrid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                </SelectiveScrollingGrid.RowDefinitions>
                                                <SelectiveScrollingGrid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                </SelectiveScrollingGrid.ColumnDefinitions>
                                                <DataGridCellsPresenter Grid.Column="0"
                                                                        Grid.Row="0" />
                                            </SelectiveScrollingGrid>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGrid.Resources>

                    <DataGrid.Columns>
                        <DataGridTextColumn HeaderStyle="{StaticResource CustomerText}"
                                            Width="2*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.Binding>
                                <MultiBinding StringFormat="{}{0} {1}">
                                    <Binding Path="KlijentIdKlijentNavigation.Ime" />
                                    <Binding Path="KlijentIdKlijentNavigation.Prezime" />
                                </MultiBinding>
                            </DataGridTextColumn.Binding>
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn HeaderStyle="{StaticResource VehicleText}"
                                            Width="2*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.Binding>
                                <MultiBinding StringFormat="{}{0} {1}">
                                    <Binding Path="VoziloIdVoziloNavigation.Marka" />
                                    <Binding Path="VoziloIdVoziloNavigation.Model" />
                                </MultiBinding>
                            </DataGridTextColumn.Binding>
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn HeaderStyle="{StaticResource RentalDateText}"
                                            Binding="{Binding DatumIznajmljivanja, StringFormat='dd/MM/yyyy'}"
                                            Width="*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn HeaderStyle="{StaticResource ReturnDateText}"
                                            Binding="{Binding DatumVracanja, StringFormat='dd/MM/yyyy'}"
                                            Width="*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn HeaderStyle="{StaticResource StatusText}"
                                            Binding="{Binding StatusIznajmljivanjaIdStatusIznajmljivanjaNavigation.NazivStatusa}"
                                            Width="*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn HeaderStyle="{StaticResource PriceText}"
                                            Binding="{Binding Cijena, StringFormat={}{0:C}}"
                                            Width="*"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTemplateColumn HeaderStyle="{StaticResource ActionText}"
                                                Width="*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal"
                                                HorizontalAlignment="Center">
                                        <Button Margin="5,0"
                                                Click="ViewRentalButton_Click"
                                                Background="Transparent"
                                                BorderBrush="Transparent"
                                                ToolTip="{DynamicResource View}">
                                            <Image Source="pack://application:,,,/Res/showdetails.png"
                                                   Width="30"
                                                   Height="30" />
                                        </Button>
                                        <Button Margin="5,0"
                                                Click="EditRentalButton_Click"
                                                Background="Transparent"
                                                BorderBrush="Transparent"
                                                ToolTip="{DynamicResource Edit}">
                                            <Image Source="pack://application:,,,/Res/edit.png"
                                                   Width="25"
                                                   Height="25" />
                                        </Button>
                                        <Button Margin="5,0,20,0"
                                                Click="DeleteRentalButton_Click"
                                                Background="Transparent"
                                                BorderBrush="Transparent"
                                                ToolTip="{DynamicResource Delete}">
                                            <Image Source="pack://application:,,,/Res/delete.png"
                                                   Width="20"
                                                   Height="20" />
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Poruka da nema podataka -->
                <TextBlock Text="{DynamicResource NoAvailableData}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           FontSize="16"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           Visibility="{Binding HasItems, ElementName=RentalsDataGrid, Converter={StaticResource InverseBooleanToVisibilityConverter}}" />
            </Grid>
        </Grid>

        <!-- Add Rental Content -->
        <Grid x:Name="AddRentalContent"
              Visibility="{Binding IsShowingList, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Header with back button -->
            <Grid Grid.Row="0"
                  Margin="20,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Back button with left arrow -->
                <Button Width="50"
                        Height="50"
                        Margin="0,0,15,0"
                        BorderThickness="0"
                        Click="BackButton_Click"
                        Background="Transparent"
                        ToolTip="{DynamicResource Back}">
                    <TextBlock Text="«"
                               VerticalAlignment="Center"
                               FontSize="24"
                               Foreground="{DynamicResource TextPrimaryBrush}" />
                </Button>

                <!-- Title -->
                <TextBlock Grid.Column="1"
                           Text="{DynamicResource AddRental}"
                           FontSize="24"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
            </Grid>

            <!-- Rental form content area -->
            <Grid Grid.Row="1"
                  Margin="20,0,20,20">
                <local:ReservationMaker 
                                        
                                        x:Name="reservationMakerControl"
                                        ReservationCompleted="ReservationMaker_ReservationCompleted" 
                                        ReservationCancelled="ReservationMaker_ReservationCancelled"
                                        >
                    
                </local:ReservationMaker>
            </Grid>
        </Grid>
    </Grid>
</UserControl>